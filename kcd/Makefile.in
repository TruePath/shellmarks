#
# Contents from ad.prepend
#
# Makefile for KCD
# Copyright (c) 1997,1998,1999,2000,2002,2004,2007 Kriang Lerdsuwanakij
# email:	lerdsuwa@users.sourceforge.net
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
#

PACKAGE		= @PACKAGE@
VERSION		= @VERSION@

SHELL		= /bin/sh
@SET_MAKE@

datarootdir	= @datarootdir@
srcdir		= @srcdir@
VPATH		= @srcdir@
top_srcdir	= @top_srcdir@
top_builddir	= @top_builddir@

prefix		= @prefix@
exec_prefix	= @exec_prefix@
bindir		= @bindir@
libdir		= @libdir@
includedir	= @includedir@
mandir		= @mandir@
man1dir		= $(mandir)/man1
docdir		= @docdir@
etcdir		= @sysconfdir@
etcdir2		= @prefix@/etc
localedir	= @datadir@/locale

# DESTDIR used in rules below is undefined by default.
# It will be defined when building package.

CC		= @CC@
CXX		= @CXX@
CPP		= @CPP@
CXXCPP		= @CXXCPP@

CFLAGS		= @CFLAGS@
CXXFLAGS	= @CXXFLAGS@
CPPFLAGS	= @CPPFLAGS@

CCFLAGS		= $(CPPFLAGS) $(CFLAGS)
CXXCFLAGS	= $(CPPFLAGS) $(CXXFLAGS)

LDFLAGS		= @LDFLAGS@
LIBS		= @LIBINTL@ @LIBS@

INSTALL		= @INSTALL@
INSTALL_PROGRAM	= @INSTALL_PROGRAM@
INSTALL_DATA	= @INSTALL_DATA@


#
# Generated by autodep 1.1.4.  DO NOT modify this line.
#

adDIRS = po

adEXECS = kcdmain

adINTFILES = $(adOBJS)

adMAKESUBDIR_TESTS = adMakeSubdir $(adTESTS)

adOBJS = buffer.o conffile.o confobj.o cstrlib.o dirobj.o dirtree.o dirutil.o \
         editbox.o error.o gentree.o gtstream.o gzfileio.o kcdmain.o khdoc.o \
         khwin.o miscobj.o scandir.o scrnman.o scroll.o seek.o statwin.o \
         strmisc.o utf8dec.o

adOUTFILES = $(adEXECS)

adTESTS = $(adINTFILES) $(adOUTFILES)

adTESTS_MAKESUBDIR = $(adTESTS) adMakeSubdir

adBeginSubdir = test -z "$(adDIRS)" ||    \
                for d in . $(adDIRS) ; do \
                  test $$d != . && (cd $$d; $(MAKE)

adEndSubdir =                                      );   \
                done

#
# Default target
#

all : default-target

adMakeSubdir :
	$(adBeginSubdir) all $(adEndSubdir)

#
# Rules for all target
#

# Compiling C/C++ sources

buffer.o : Makefile $(srcdir)/buffer.cc $(srcdir)/buffer.h config.h \
           $(srcdir)/cxxlib.h $(srcdir)/error.h $(srcdir)/gtstream.h \
           $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/buffer.cc

conffile.o : Makefile $(srcdir)/buffer.h $(srcdir)/conffile.cc \
             $(srcdir)/conffile.h config.h $(srcdir)/confobj.h \
             $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h $(srcdir)/dirutil.h \
             $(srcdir)/editbox.h $(srcdir)/error.h $(srcdir)/gtstream.h \
             $(srcdir)/gzfileio.h $(srcdir)/khdoc.h $(srcdir)/khwin.h \
             $(srcdir)/list.h $(srcdir)/miscobj.h $(srcdir)/scrnman.h \
             $(srcdir)/scroll.h $(srcdir)/seek.h $(srcdir)/setupcurses.h \
             $(srcdir)/statwin.h $(srcdir)/strmisc.h $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/conffile.cc \
	       -DKCD_ETCDIR=\""$(etcdir)"\"

confobj.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/confobj.cc \
            $(srcdir)/confobj.h $(srcdir)/cstrlib.h $(srcdir)/gtstream.h \
            $(srcdir)/gzfileio.h $(srcdir)/list.h $(srcdir)/setupcurses.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/confobj.cc

cstrlib.o : Makefile config.h $(srcdir)/cstrlib.cc $(srcdir)/cstrlib.h \
            $(srcdir)/list.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/cstrlib.cc

dirobj.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cstrlib.h \
           $(srcdir)/dirobj.cc $(srcdir)/dirobj.h $(srcdir)/error.h \
           $(srcdir)/gtstream.h $(srcdir)/gzfileio.h $(srcdir)/list.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/dirobj.cc

dirtree.o : Makefile $(srcdir)/buffer.h $(srcdir)/conffile.h config.h \
            $(srcdir)/confobj.h $(srcdir)/cstrlib.h $(srcdir)/dirobj.h \
            $(srcdir)/dirtree.cc $(srcdir)/dirtree.h $(srcdir)/error.h \
            $(srcdir)/gentree.h $(srcdir)/gtstream.h $(srcdir)/gzfileio.h \
            $(srcdir)/list.h $(srcdir)/scandir.h $(srcdir)/setupcurses.h \
            $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/dirtree.cc

dirutil.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cstrlib.h \
            $(srcdir)/dirutil.cc $(srcdir)/dirutil.h $(srcdir)/error.h \
            $(srcdir)/gtstream.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/dirutil.cc

editbox.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/confobj.h \
            $(srcdir)/editbox.cc $(srcdir)/editbox.h $(srcdir)/error.h \
            $(srcdir)/gtstream.h $(srcdir)/gzfileio.h $(srcdir)/list.h \
            $(srcdir)/setupcurses.h $(srcdir)/strmisc.h $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/editbox.cc

error.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/error.cc \
          $(srcdir)/error.h $(srcdir)/gtstream.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/error.cc

gentree.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/confobj.h \
            $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h $(srcdir)/dirobj.h \
            $(srcdir)/dirtree.h $(srcdir)/dirutil.h $(srcdir)/editbox.h \
            $(srcdir)/error.h $(srcdir)/gentree.cc $(srcdir)/gentree.h \
            $(srcdir)/gtstream.h $(srcdir)/gzfileio.h $(srcdir)/khdoc.h \
            $(srcdir)/khwin.h $(srcdir)/list.h $(srcdir)/miscobj.h \
            $(srcdir)/scandir.h $(srcdir)/scrnman.h $(srcdir)/scroll.h \
            $(srcdir)/setupcurses.h $(srcdir)/statwin.h $(srcdir)/strmisc.h \
            $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/gentree.cc

gtstream.o : Makefile config.h $(srcdir)/gtstream.cc $(srcdir)/gtstream.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/gtstream.cc

gzfileio.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/error.h \
             $(srcdir)/gtstream.h $(srcdir)/gzfileio.cc $(srcdir)/gzfileio.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/gzfileio.cc

kcdmain.o : Makefile $(srcdir)/buffer.h $(srcdir)/conffile.h config.h \
            $(srcdir)/confobj.h $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h \
            $(srcdir)/dirobj.h $(srcdir)/dirtree.h $(srcdir)/dirutil.h \
            $(srcdir)/error.h $(srcdir)/gentree.h $(srcdir)/gtstream.h \
            $(srcdir)/gzfileio.h $(srcdir)/kcdmain.cc $(srcdir)/list.h \
            $(srcdir)/scandir.h $(srcdir)/setupcurses.h $(srcdir)/strmisc.h \
            $(srcdir)/version.cc
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/kcdmain.cc \
	       -DKCD_LOCALEDIR=\""$(localedir)"\"

khdoc.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cstrlib.h \
          $(srcdir)/cxxlib.h $(srcdir)/error.h $(srcdir)/gtstream.h \
          $(srcdir)/gzfileio.h $(srcdir)/khdoc.cc $(srcdir)/khdoc.h \
          $(srcdir)/list.h $(srcdir)/miscobj.h $(srcdir)/seek.h \
          $(srcdir)/setupcurses.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/khdoc.cc

khwin.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/confobj.h \
          $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h $(srcdir)/editbox.h \
          $(srcdir)/error.h $(srcdir)/gtstream.h $(srcdir)/gzfileio.h \
          $(srcdir)/khdoc.h $(srcdir)/khwin.cc $(srcdir)/khwin.h \
          $(srcdir)/list.h $(srcdir)/miscobj.h $(srcdir)/scrnman.h \
          $(srcdir)/scroll.h $(srcdir)/setupcurses.h $(srcdir)/statwin.h \
          $(srcdir)/strmisc.h $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/khwin.cc

miscobj.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cxxlib.h \
            $(srcdir)/error.h $(srcdir)/gtstream.h $(srcdir)/miscobj.cc \
            $(srcdir)/miscobj.h $(srcdir)/setupcurses.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/miscobj.cc

scandir.o : Makefile $(srcdir)/buffer.h $(srcdir)/conffile.h config.h \
            $(srcdir)/confobj.h $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h \
            $(srcdir)/dirobj.h $(srcdir)/dirtree.h $(srcdir)/error.h \
            $(srcdir)/gentree.h $(srcdir)/gtstream.h $(srcdir)/gzfileio.h \
            $(srcdir)/list.h $(srcdir)/scandir.cc $(srcdir)/scandir.h \
            $(srcdir)/setupcurses.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/scandir.cc

scrnman.o : Makefile config.h $(srcdir)/cxxlib.h $(srcdir)/list.h \
            $(srcdir)/miscobj.h $(srcdir)/scrnman.cc $(srcdir)/scrnman.h \
            $(srcdir)/setupcurses.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/scrnman.cc

scroll.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cxxlib.h \
           $(srcdir)/error.h $(srcdir)/gtstream.h $(srcdir)/list.h \
           $(srcdir)/miscobj.h $(srcdir)/scrnman.h $(srcdir)/scroll.cc \
           $(srcdir)/scroll.h $(srcdir)/setupcurses.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/scroll.cc

seek.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/cxxlib.h \
         $(srcdir)/error.h $(srcdir)/gtstream.h $(srcdir)/seek.cc \
         $(srcdir)/seek.h $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/seek.cc

statwin.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/confobj.h \
            $(srcdir)/cstrlib.h $(srcdir)/cxxlib.h $(srcdir)/editbox.h \
            $(srcdir)/error.h $(srcdir)/gtstream.h $(srcdir)/gzfileio.h \
            $(srcdir)/khdoc.h $(srcdir)/khwin.h $(srcdir)/list.h \
            $(srcdir)/miscobj.h $(srcdir)/scrnman.h $(srcdir)/scroll.h \
            $(srcdir)/setupcurses.h $(srcdir)/statwin.cc $(srcdir)/statwin.h \
            $(srcdir)/strmisc.h $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/statwin.cc

strmisc.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/error.h \
            $(srcdir)/gtstream.h $(srcdir)/list.h $(srcdir)/strmisc.cc \
            $(srcdir)/strmisc.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/strmisc.cc

utf8dec.o : Makefile $(srcdir)/buffer.h config.h $(srcdir)/error.h \
            $(srcdir)/gtstream.h $(srcdir)/strmisc.h $(srcdir)/utf8dec.cc \
            $(srcdir)/utf8dec.h
	$(CXX) $(CXXCFLAGS) -c $(srcdir)/utf8dec.cc

# Linking kcdmain

kcdmain : Makefile buffer.o conffile.o confobj.o cstrlib.o dirobj.o dirtree.o \
          dirutil.o editbox.o error.o gentree.o gtstream.o gzfileio.o \
          kcdmain.o khdoc.o khwin.o miscobj.o scandir.o scrnman.o scroll.o \
          seek.o statwin.o strmisc.o utf8dec.o
	$(CXX) -o kcdmain $(CXXFLAGS) $(LDFLAGS) buffer.o conffile.o \
	       confobj.o cstrlib.o dirobj.o dirtree.o dirutil.o editbox.o \
	       error.o gentree.o gtstream.o gzfileio.o kcdmain.o khdoc.o \
	       khwin.o miscobj.o scandir.o scrnman.o scroll.o seek.o \
	       statwin.o strmisc.o utf8dec.o $(LIBS)

#
# End of output from ad.rule.  DO NOT modify this line.
#

#
# Contents from ad.append
#
#
# Default target
#

default-target: kcdmain

default-po:
	if [ ! "@GMSGFMT@" = ":" ]; then	\
		cd po;				\
		$(MAKE) kcd.pot;		\
	fi
	perl "$(srcdir)"/scripts/copy-message.pl \
		-d CHARSET utf-8 \
		-d DATE "`date "+%Y-%m-%d %H:%M%z"`" \
		-d VERSION $(VERSION) \
		-f "$(srcdir)"/scripts/copy-message < po/kcd.pot \
		| perl "$(srcdir)"/scripts/utf-quotes.pl > po/en_US.UTF-8.po
	perl "$(srcdir)"/scripts/copy-message.pl \
		-d CHARSET iso-8859-1 \
		-d DATE "`date "+%Y-%m-%d %H:%M%z"`" \
		-d VERSION $(VERSION) \
		-f "$(srcdir)"/scripts/copy-message < po/kcd.pot \
		| perl "$(srcdir)"/scripts/en_GB.pl > po/en_GB.po
	perl "$(srcdir)"/scripts/copy-message.pl \
		-d CHARSET utf-8 \
		-d DATE "`date "+%Y-%m-%d %H:%M%z"`" \
		-d VERSION $(VERSION) \
		-f "$(srcdir)"/scripts/copy-message < po/kcd.pot \
		| perl "$(srcdir)"/scripts/en_GB.pl \
		| perl "$(srcdir)"/scripts/utf-quotes.pl > po/en_GB.UTF-8.po
	if [ ! "@GMSGFMT@" = ":" ]; then	\
		cd po;				\
		$(MAKE);			\
	fi

#
# Strip symbol table
#

strip:
	strip kcdmain

#
# Clean
#

clean-subdir:
	$(adBeginSubdir) clean $(adEndSubdir)

clean-curdir:
	rm -f $(adOBJS) kcdgz.1 kcdgz.1.gz kcdbz2.1 kcdbz2.1.bz2

clean: clean-subdir clean-curdir

distclean-subdir:
	$(adBeginSubdir) distclean $(adEndSubdir)

distclean-curdir: clean-curdir
	rm -f kcdmain kcd.sh.init kcd.csh.init kcd-inst
	rm -f config.h config.cache config.log
	rm -f config.status Makefile curses.h
	rm -f core "$(srcdir)"/*~
	rm -f po/en_US.UTF-8.po po/en_GB.po po/en_GB.UTF-8.po

distclean: distclean-subdir distclean-curdir

mostlyclean-subdir:
	$(adBeginSubdir) mostlyclean $(adEndSubdir)

mostlyclean-curdir: clean-curdir

mostlyclean: mostlyclean-subdir mostlyclean-curdir

maintainer-clean-subdir:
	$(adBeginSubdir) maintainer-clean $(adEndSubdir)

maintainer-clean-curdir: distclean-curdir
	rm -f "$(srcdir)"/NEWS "$(srcdir)/README
	rm -f "$(srcdir)"/kcd-*.spec "$(srcdir)"/kcd.1
	rm -f "$(srcdir)"/version.cc

maintainer-clean: maintainer-clean-subdir maintainer-clean-curdir

#
# Install
#

install_mkdir:
	if [ ! -d "$(bindir)" ]; then		\
		mkdir -p "$(bindir)";		\
		chmod 755 "$(bindir)";		\
	fi
	if [ ! -d "$(man1dir)" ]; then		\
		mkdir -p "$(man1dir)";		\
		chmod 755 "$(man1dir)";		\
	fi
	if [ -w "$(etcdir)" ]; then		\
		if [ ! -d "$(etcdir)" ]; then	\
			mkdir -p "$(etcdir)";	\
			chmod 755 "$(etcdir)";	\
		fi				\
	else					\
		if [ ! -d "$(etcdir2)" ]; then	\
			mkdir -p "$(etcdir2)";	\
			chmod 755 "$(etcdir2)";	\
		fi				\
	fi

install: install_mkdir
	$(INSTALL_PROGRAM) "$(srcdir)"/kcdscr "$(bindir)"/kcdscr
	$(INSTALL_PROGRAM) kcdmain "$(bindir)"/kcdmain
	$(INSTALL_PROGRAM) kcd-inst "$(bindir)"/kcd-inst
	-if [ "`echo $(man1dir)/*.bz2`" != "$(man1dir)/*.bz2" -o            \
	      "`echo /usr/man/man1/*.bz2`" != "/usr/man/man1/*.bz2" ]; then \
		cp "$(srcdir)"/kcd.1 kcdbz2.1;                              \
		bzip2 -9 -f kcdbz2.1;                                       \
		$(INSTALL_DATA) kcdbz2.1.bz2 "$(man1dir)"/kcd.1.bz2;        \
	elif [ "`echo $(man1dir)/*.gz`" != "$(man1dir)/*.gz" -o             \
	       "`echo /usr/man/man1/*.gz`" != "/usr/man/man1/*.gz" ]; then  \
		cp "$(srcdir)"/kcd.1 kcdgz.1;                               \
		gzip -9 -f kcdgz.1;                                         \
		$(INSTALL_DATA) kcdgz.1.gz "$(man1dir)"/kcd.1.gz;           \
	else                                                                \
		$(INSTALL_DATA) "$(srcdir)"/kcd.1 "$(man1dir)"/kcd.1;       \
	fi
	if [ -w "$(etcdir)" ]; then						        \
		if [ -d "$(etcdir)"/profile.d ]; then                                   \
			$(INSTALL_PROGRAM) kcd.sh.init "$(etcdir)"/profile.d/kcd.sh;    \
			$(INSTALL_PROGRAM) kcd.csh.init "$(etcdir)"/profile.d/kcd.csh;  \
		else                                                                    \
			$(INSTALL_DATA) kcd.sh.init "$(etcdir)"/kcd.sh.init;            \
			$(INSTALL_DATA) kcd.csh.init "$(etcdir)"/kcd.csh.init;          \
		fi								        \
	else									        \
		if [ -d "$(etcdir2)"/profile.d ]; then                                  \
			$(INSTALL_PROGRAM) kcd.sh.init "$(etcdir2)"/profile.d/kcd.sh;   \
			$(INSTALL_PROGRAM) kcd.csh.init "$(etcdir2)"/profile.d/kcd.csh; \
		else                                                                    \
			$(INSTALL_DATA) kcd.sh.init "$(etcdir2)"/kcd.sh.init;           \
			$(INSTALL_DATA) kcd.csh.init "$(etcdir2)"/kcd.csh.init;         \
		fi								        \
	fi
	if [ ! "@GMSGFMT@" = ":" ]; then				 \
		cd po;							 \
		$(MAKE) prefix="$(prefix)" DESTDIR="$(DESTDIR)" install; \
	fi

installdoc_mkdir:
	if [ ! -d "$(docdir)" ]; then				\
		mkdir -p "$(docdir)";				\
		chmod 755 "$(docdir)";				\
	fi

installdoc: installdoc_mkdir
	$(INSTALL_DATA) README "$(docdir)"/README
	$(INSTALL_DATA) NEWS "$(docdir)"/NEWS
	$(INSTALL_DATA) COPYING "$(docdir)"/COPYING
	$(INSTALL_DATA) FILELIST "$(docdir)"/FILELIST
	$(INSTALL_DATA) INSTALL "$(docdir)"/INSTALL
	$(INSTALL_DATA) TODO "$(docdir)"/TODO
	$(INSTALL_DATA) BUGREPORT "$(docdir)"/BUGREPORT
	$(INSTALL_DATA) UNICODE "$(docdir)"/UNICODE
	$(INSTALL_DATA) RPM "$(docdir)"/RPM

#
# Development rules
#

"$(srcdir)"/aclocal.m4: "$(srcdir)"/acinclude.m4/cxxac.m4 \
		      "$(srcdir)"/acinclude.m4/ncurses.m4 \
		      "$(srcdir)"/acinclude.m4/zlib.m4
	cd "$(srcdir)" && aclocal -I acinclude.m4

"$(srcdir)"/config.h.in: "$(srcdir)"/config.h.bot "$(srcdir)"/acconfig.h \
		       "$(srcdir)"/configure.in
	cd "$(srcdir)" && autoheader && touch "$(srcdir)"/config.h.in

"$(srcdir)"/configure: "$(srcdir)"/configure.in "$(srcdir)"/aclocal.m4
	cd "$(srcdir)" && autoconf

# Note: we should detect changes in source & header files too
"$(srcdir)"/Makefile.in: "$(srcdir)"/ad.rule "$(srcdir)"/ad.append \
		       "$(srcdir)"/ad.prepend
	cd "$(srcdir)" && autodep

html:
	cd "$(srcdir)"/doc && rm -rf *.html && docbook2html kcd.sgml
